@page "/{eventId}/{eventRole}/faq"
@model ServerCore.Pages.EventSpecific.FAQModel
@{
    ViewData["Title"] = "FAQ";
    ViewData["AdminRoute"] = "/EventSpecific/FAQ";
    ViewData["AuthorRoute"] = "/EventSpecific/FAQ";
    ViewData["PlayRoute"] = "/EventSpecific/FAQ";
    var eventPage = Model as ServerCore.ModelBases.EventSpecificPageModel;
    var Event = eventPage?.Event;
    string fileStoragePrefix = "";
    if (eventPage != null)
    {
        fileStoragePrefix = eventPage.GetFileStoragePrefix();
    }
}

@if (Event.EventBegin.Year < 2024)
{
    <partial name="../Resources/@(Event.HomePartial ?? "Default")/FAQPartial.cshtml" />
}
else
{
    if (!string.IsNullOrEmpty(Event.FAQContent))
    {
        @Html.Raw(Event.FAQContent);
    }
    <style>
        #faq-frame {
            width: 100%;
        }
        #faq-frame.unsized {
            height: 85vh;
        }
    </style>
    <script type="text/javascript">
        window.addEventListener("load", () => {
            const iframe = document.querySelector("#faq-frame");
            if ((iframe !== null) && (iframe !== undefined)) {
                iframe.contentWindow.postMessage("", "*");
            }
            setTimeout(() => {
                const iframe = document.querySelector("#faq-frame");
                if ((iframe !== null) && (iframe !== undefined)) {
                    if (iframe.classList.contains("unsized")) {
                        iframe.style.display = "none";
                    }
                }
            }, "1000");
        });
        window.addEventListener("resize", (e) => {
            const iframe = document.querySelector("#faq-frame");
            if ((iframe !== null) && (iframe !== undefined)) {
                iframe.contentWindow.postMessage("", "*");
            }
        });
        window.addEventListener("message", (e) => {
            if ((e.data.width > 0) && (e.data.height > 0)) {
                const iframe = document.querySelector("#faq-frame");
                iframe.classList.remove("unsized");
                iframe.height = e.data.height + 30;
            }
        });
    </script>
    <iframe id="faq-frame" class="unsized" title="FAQ Content" sandbox="allow-same-origin allow-scripts allow-popups" src="@(fileStoragePrefix)/resources/faq-content.html"></iframe>
}